<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Joining data sources together | Introduction to the principles of data wrangling and visualisation in R</title>
  <meta name="description" content="15 Joining data sources together | Introduction to the principles of data wrangling and visualisation in R" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Joining data sources together | Introduction to the principles of data wrangling and visualisation in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://seankross.com/bookdown-start/" />
  
  
  <meta name="github-repo" content="seankross/bookdown-start" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Joining data sources together | Introduction to the principles of data wrangling and visualisation in R" />
  
  
  

<meta name="author" content="Dan Olner" />


<meta name="date" content="2021-08-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using-factors-to-control-order-of-variables.html"/>
<link rel="next" href="saving-ggplots-as-image-files.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to the principles of data wrangling and visualisation in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="getting-r-and-rstudio.html"><a href="getting-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Getting R and RStudio</a></li>
<li class="chapter" data-level="3" data-path="r-studio.html"><a href="r-studio.html"><i class="fa fa-check"></i><b>3</b> R-Studio</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-studio.html"><a href="r-studio.html#a-first-look-at-rstudio"><i class="fa fa-check"></i><b>3.1</b> A first look at RStudio</a></li>
<li class="chapter" data-level="3.2" data-path="r-studio.html"><a href="r-studio.html#entering-commands-in-r"><i class="fa fa-check"></i><b>3.2</b> Entering commands in R</a></li>
<li class="chapter" data-level="3.3" data-path="r-studio.html"><a href="r-studio.html#assigning-to-variables"><i class="fa fa-check"></i><b>3.3</b> Assigning to variables</a></li>
<li class="chapter" data-level="3.4" data-path="r-studio.html"><a href="r-studio.html#opening-a-project-in-rstudio"><i class="fa fa-check"></i><b>3.4</b> Opening a project in RStudio</a></li>
<li class="chapter" data-level="3.5" data-path="r-studio.html"><a href="r-studio.html#creating-a-new-script-and-running-code-in-it"><i class="fa fa-check"></i><b>3.5</b> Creating a new script and running code in it</a></li>
<li class="chapter" data-level="3.6" data-path="r-studio.html"><a href="r-studio.html#but-will-it-make-sense-in-two-months-time-using-comments-and-sections"><i class="fa fa-check"></i><b>3.6</b> ‘But will it make sense in two month’s time…?’ Using comments and sections</a></li>
<li class="chapter" data-level="3.7" data-path="r-studio.html"><a href="r-studio.html#its-all-about-the-libraries"><i class="fa fa-check"></i><b>3.7</b> It’s all about the libraries</a></li>
<li class="chapter" data-level="3.8" data-path="r-studio.html"><a href="r-studio.html#loading-a-file-into-a-dataframe-and-examining-the-data"><i class="fa fa-check"></i><b>3.8</b> Loading a file into a dataframe and examining the data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>4</b> Introduction</a></li>
<li class="chapter" data-level="5" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>5</b> Getting started</a></li>
<li class="chapter" data-level="6" data-path="loading-the-libraries.html"><a href="loading-the-libraries.html"><i class="fa fa-check"></i><b>6</b> Loading the libraries</a></li>
<li class="chapter" data-level="7" data-path="loading-the-house-price-data.html"><a href="loading-the-house-price-data.html"><i class="fa fa-check"></i><b>7</b> Loading the house price data</a></li>
<li class="chapter" data-level="8" data-path="lets-jump-right-into-ggplot.html"><a href="lets-jump-right-into-ggplot.html"><i class="fa fa-check"></i><b>8</b> Let’s jump right into ggplot</a></li>
<li class="chapter" data-level="9" data-path="the-lubridate-library.html"><a href="the-lubridate-library.html"><i class="fa fa-check"></i><b>9</b> The lubridate library</a></li>
<li class="chapter" data-level="10" data-path="using-ggplots-own-stat-functions.html"><a href="using-ggplots-own-stat-functions.html"><i class="fa fa-check"></i><b>10</b> Using ggplot’s own stat functions</a></li>
<li class="chapter" data-level="11" data-path="getting-started-with-dplyr-and-piping.html"><a href="getting-started-with-dplyr-and-piping.html"><i class="fa fa-check"></i><b>11</b> Getting started with <strong>dplyr</strong> and <strong>piping</strong></a>
<ul>
<li class="chapter" data-level="11.1" data-path="getting-started-with-dplyr-and-piping.html"><a href="getting-started-with-dplyr-and-piping.html#piping"><i class="fa fa-check"></i><b>11.1</b> Piping!</a></li>
<li class="chapter" data-level="11.2" data-path="getting-started-with-dplyr-and-piping.html"><a href="getting-started-with-dplyr-and-piping.html#dplyrs-verbs"><i class="fa fa-check"></i><b>11.2</b> <strong>dplyr</strong>’s verbs</a></li>
<li class="chapter" data-level="11.3" data-path="getting-started-with-dplyr-and-piping.html"><a href="getting-started-with-dplyr-and-piping.html#and-a-few-extras-while-were-here"><i class="fa fa-check"></i><b>11.3</b> And a few extras while we’re here…</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="using-scales-to-control-appearance.html"><a href="using-scales-to-control-appearance.html"><i class="fa fa-check"></i><b>12</b> Using scales to control appearance</a></li>
<li class="chapter" data-level="13" data-path="scales-for-controlling-colour.html"><a href="scales-for-controlling-colour.html"><i class="fa fa-check"></i><b>13</b> Scales for controlling colour</a></li>
<li class="chapter" data-level="14" data-path="using-factors-to-control-order-of-variables.html"><a href="using-factors-to-control-order-of-variables.html"><i class="fa fa-check"></i><b>14</b> Using factors to control order of variables</a></li>
<li class="chapter" data-level="15" data-path="joining-data-sources-together.html"><a href="joining-data-sources-together.html"><i class="fa fa-check"></i><b>15</b> Joining data sources together</a>
<ul>
<li class="chapter" data-level="15.1" data-path="joining-data-sources-together.html"><a href="joining-data-sources-together.html#gathering-into-long-form"><i class="fa fa-check"></i><b>15.1</b> `Gathering’ into long form</a></li>
<li class="chapter" data-level="15.2" data-path="joining-data-sources-together.html"><a href="joining-data-sources-together.html#saving-and-reloading-the-housing-data"><i class="fa fa-check"></i><b>15.2</b> Saving and reloading the housing data</a></li>
<li class="chapter" data-level="15.3" data-path="joining-data-sources-together.html"><a href="joining-data-sources-together.html#merging-the-housing-and-wages-data"><i class="fa fa-check"></i><b>15.3</b> Merging the housing and wages data</a></li>
<li class="chapter" data-level="15.4" data-path="joining-data-sources-together.html"><a href="joining-data-sources-together.html#choosing-a-subset-based-on-some-criterion"><i class="fa fa-check"></i><b>15.4</b> Choosing a subset based on some criterion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="saving-ggplots-as-image-files.html"><a href="saving-ggplots-as-image-files.html"><i class="fa fa-check"></i><b>16</b> Saving ggplots as image files</a>
<ul>
<li class="chapter" data-level="16.1" data-path="saving-ggplots-as-image-files.html"><a href="saving-ggplots-as-image-files.html#time-for-a-pause"><i class="fa fa-check"></i><b>16.1</b> Time for a pause!</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="six-and-a-bit-options.html"><a href="six-and-a-bit-options.html"><i class="fa fa-check"></i><b>17</b> SIX (and a bit) OPTIONS</a></li>
<li class="chapter" data-level="18" data-path="prettifying-a-graph.html"><a href="prettifying-a-graph.html"><i class="fa fa-check"></i><b>18</b> Prettifying a graph</a></li>
<li class="chapter" data-level="19" data-path="facetting-and-dodging-getting-as-much-info-into-one-graph-as-humanly-possible.html"><a href="facetting-and-dodging-getting-as-much-info-into-one-graph-as-humanly-possible.html"><i class="fa fa-check"></i><b>19</b> Facetting and dodging: getting as much info into one graph as humanly possible</a></li>
<li class="chapter" data-level="20" data-path="iteration.html"><a href="iteration.html"><i class="fa fa-check"></i><b>20</b> Iteration</a>
<ul>
<li class="chapter" data-level="20.1" data-path="iteration.html"><a href="iteration.html#outputting-multiple-plots"><i class="fa fa-check"></i><b>20.1</b> 1. Outputting multiple plots</a></li>
<li class="chapter" data-level="20.2" data-path="iteration.html"><a href="iteration.html#pulling-out-multiple-model-values-and-visualising-them"><i class="fa fa-check"></i><b>20.2</b> 2. Pulling out multiple model values and visualising them</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="a-little-bit-of-mapping.html"><a href="a-little-bit-of-mapping.html"><i class="fa fa-check"></i><b>21</b> A little bit of mapping</a>
<ul>
<li class="chapter" data-level="21.1" data-path="a-little-bit-of-mapping.html"><a href="a-little-bit-of-mapping.html#one-simple-way-to-use-ggplot-for-mapping-the-2d-geoms"><i class="fa fa-check"></i><b>21.1</b> One simple way to use ggplot for mapping: the 2D geoms</a></li>
<li class="chapter" data-level="21.2" data-path="a-little-bit-of-mapping.html"><a href="a-little-bit-of-mapping.html#using-cowplot-to-get-around-the-facetting-problem"><i class="fa fa-check"></i><b>21.2</b> Using cowplot to get around the facetting problem</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="making-a-map-using-the-simple-features-library-tmap-and-a-bit-of-wrangling.html"><a href="making-a-map-using-the-simple-features-library-tmap-and-a-bit-of-wrangling.html"><i class="fa fa-check"></i><b>22</b> Making a map using the simple features library, tmap and a bit of wrangling</a></li>
<li class="chapter" data-level="23" data-path="a-last-little-ggplot-mapping-example.html"><a href="a-last-little-ggplot-mapping-example.html"><i class="fa fa-check"></i><b>23</b> A last little ggplot mapping example</a></li>
<li class="chapter" data-level="24" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>24</b> Data sources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to the principles of data wrangling and visualisation in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="joining-data-sources-together" class="section level1" number="15">
<h1><span class="header-section-number">15</span> Joining data sources together</h1>
<p>It would be very useful to be able to <strong>adjust our house price data to something that’s consistent over time</strong>. But how? We could use some value for inflation, but this doesn’t actually include house price change and would only provide a single adjustment figure for the whole of England.</p>
<p><strong>Another option is to use wages over time</strong>. Not only does this give a simple measure of house cost - <strong>house price as a multiple of the average wage</strong> - but it varies by region, giving a much more localised measure.</p>
<p>To do this, <strong>we need to link the housing data to wage data</strong>. Linking two datasets together is often an essential part of visualisation when there is a need to compare or supplement information.</p>
<p>R’s base commands are not bad for this, but <strong>dplyr’s join functions</strong> do the job a little bit quicker.</p>
<p>So first, let’s <strong>load the wage data</strong> (taken from NOMIS). It’s in CSV format and we’ll use the <strong>readr library</strong> mentioned earlier, loaded as part of the <strong>tidyverse package</strong>. Again, remember - you can type ‘data/med’ and use autocomplete to get the rest of the file name.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="joining-data-sources-together.html#cb144-1" aria-hidden="true" tabindex="-1"></a>wages <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;data/medianWages_localAuthority.csv&#39;</span>)</span></code></pre></div>
<p><strong>Click on the new dataframe in the environment panel:</strong> it consists of:</p>
<ul>
<li>a column each for the <strong>local authority name and code (the ‘mnemonic’ column)</strong></li>
<li>One column per year <strong>from 1997 to 2018</strong></li>
</ul>
<div id="gathering-into-long-form" class="section level2" number="15.1">
<h2><span class="header-section-number">15.1</span> `Gathering’ into long form</h2>
<p>We want to <strong>merge this with the housing data summary</strong> so that each median wage per year per local authority is matched against the average price at that time and place.</p>
<p>But this is currently <strong>wide data</strong> - the year variable is spread across columns. So the first thing to do: <strong>gather the years into their own column</strong> so that it matches the single year column in the house sales data.</p>
<p>This can be done with another <strong>tidyverse</strong> library: <strong>tidyr</strong>. This just requires <em>two</em> things:</p>
<ul>
<li>Give <strong>tidyr</strong> a name for the <strong>key</strong> and <strong>value</strong> columns. You can decide on these names. Let’s go for a key of <strong>year</strong> and value column name as <strong>medianwage</strong>.</li>
<li>Tell it which columns to gather.</li>
</ul>
<p>We can use the pipe operator. This looks like:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="joining-data-sources-together.html#cb145-1" aria-hidden="true" tabindex="-1"></a>wagesLong <span class="ot">&lt;-</span> wages <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="joining-data-sources-together.html#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> year, <span class="at">value =</span> medianwage, <span class="st">`</span><span class="at">1997</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2018</span><span class="st">`</span>)</span></code></pre></div>
<blockquote>
<p><strong>Note: in this case, the column names in the range we passed in needed surrounding with backticks (very top left on the keyboard). Why? If column names are numbers, R can’t parse them well - the tick marks are needed to pass in the names correctly. If they had been plain text, the ticks marks wouldn’t be needed. Another joyous R foible.</strong></p>
</blockquote>
<p>Take a look via the environment pane: we now have the <strong>wage data in long form</strong>. Note: we didn’t have to say anything about the remaining local authority columns: <strong>tidyr</strong> automatically repeats these for us.</p>
<p>Now it’s in long form, here’s an opportunity to use another <strong>stat</strong> from <strong>ggplot</strong></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="joining-data-sources-together.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wagesLong, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> medianwage)) <span class="sc">+</span></span>
<span id="cb146-2"><a href="joining-data-sources-together.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="02_viz_n_wrangling_files/figure-html/unnamed-chunk-73-1.png" width="595.2" style="display: block; margin: auto;" /></p>
<p><strong>A boxplot</strong> can help get a quick look at the shape of the data. In this case, it’s easy to see median wages going up over time - so the data looks sensible.</p>
</div>
<div id="saving-and-reloading-the-housing-data" class="section level2" number="15.2">
<h2><span class="header-section-number">15.2</span> Saving and reloading the housing data</h2>
<p>Because memory is a little tight, let’s <strong>load a different selection of the housing data.</strong> This is in exactly the same format as before, it’s just <strong>sales from a selection of local authorities</strong>, rather than TTWAs.</p>
<p><strong>If you want to save your previous sales data or any of your other dataframes, now would be a good time. We can then overwrite some of these files without fear of losing anything. Although we’ve only added the year field so far, so nothing drastic will be lost.</strong></p>
<p>The <strong>saveRDS function</strong> is a good way to do this: it saves the dataframes as compressed objects that (a) are very compact and (b) reload in exactly the same form. So for instance, saving to our data folder:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="joining-data-sources-together.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sales,<span class="st">&#39;data/salesTTWAwithYearAdded.rds&#39;</span>)</span></code></pre></div>
<p><strong>And feel free to save any other dataframes you want to return to.</strong></p>
<p>We can then <strong>overwrite the sales variable with the new price data</strong>. Again, it’s a long file name so use autocomplete again!</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="joining-data-sources-together.html#cb148-1" aria-hidden="true" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&#39;data/landRegistryPricePaidLocalAuthoritySelection.rds&#39;</span>)</span></code></pre></div>
<p>And we’ll also need to <strong>re-add the year column:</strong></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="joining-data-sources-together.html#cb149-1" aria-hidden="true" tabindex="-1"></a>sales<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">year</span>(sales<span class="sc">$</span>date)</span></code></pre></div>
<hr />
</div>
<div id="merging-the-housing-and-wages-data" class="section level2" number="15.3">
<h2><span class="header-section-number">15.3</span> Merging the housing and wages data</h2>
<p>Now we’ve got both of our datasets to combine, let’s stop for a moment and think through what we’re aiming for.</p>
<ul>
<li>The (long) wage data gives us <strong>the median wage for each year and each local authority</strong> - one row for each of these combinations.</li>
<li>We want to know <strong>how many multiples of this wage</strong> you’d pay for the <strong>average-priced house in each local authority.</strong></li>
<li>Which means, first - we need to <strong>repeat our dplyr summarising, but this time at the local authority level</strong>, so it matches our wage data. We want it to <strong>also</strong> have one row per year / local authority combination.</li>
</ul>
<p>So we first need to <strong>summarise the sales data</strong> as we did before. <strong>Notice how dplyr makes this a simple change compared to before. We just replace ttwa with the new geography:</strong></p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="joining-data-sources-together.html#cb150-1" aria-hidden="true" tabindex="-1"></a>saleSummary <span class="ot">&lt;-</span> sales <span class="sc">%&gt;%</span> </span>
<span id="cb150-2"><a href="joining-data-sources-together.html#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(localauthority,year) <span class="sc">%&gt;%</span> </span>
<span id="cb150-3"><a href="joining-data-sources-together.html#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanPrice =</span> <span class="fu">mean</span>(price))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;localauthority&#39;. You can override using the `.groups` argument.</code></pre>
<p>Looking at the result, <strong>we can see this matches the structure of <em>wagesLong</em>: one column for year and one for the local authority.</strong></p>
<blockquote>
<p>This stuff is (for me at any rate!) <strong>always a little confusing!</strong>. It is rarely an intuitive process! Taking the time to <strong>look at the data</strong> in the View panel can be really helpful for making sense of what’s going on.</p>
</blockquote>
<hr />
<blockquote>
<p><strong>We’re now ready to merge in the median wages.</strong></p>
</blockquote>
<p><strong>The dplyr cheatsheet has a neat diagram showing our various joining options.</strong> We want to use an <strong>inner join</strong> because we only want to <strong>keep local authorities that the two dataframes have in common.</strong></p>
<p><img src="02_viz_n_wrangling_files/figure-html/unnamed-chunk-78-1.png" width="288" style="display: block; margin: auto;" /></p>
<hr />
<blockquote>
<p><strong>When doing joins, it’s generally wise to make a new variable. Joins often go wrong on first attempts: it’s useful to be able to compare with the previous data to make sure it’s done what you wanted it to.</strong></p>
</blockquote>
<blockquote>
<p>Note also: when merging/joining, it’s often necessary to do some checks that the data is formatted in the same way in both cases for the join fields, especially for variables like postcodes that may contain spaces. We’ll see an example of this in a moment…</p>
</blockquote>
<hr />
<p>The <strong>dplyr cheatsheet</strong> shows how to use join to merge on single variables - that’s nice and straightforward. But there are two more things to consider here:</p>
<ul>
<li><strong>We want to join on both year <em>and</em> local authority.</strong> This is solved by passing in a <strong>vector of the columns to join on</strong>.</li>
<li><strong>The variable name containing the local authorities is <em>not the same</em> in both dataframes.</strong> This is solved by <strong>supplying both names connected with an equals</strong>.</li>
</ul>
<p>This looks like this, and <em>should</em> work…</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="joining-data-sources-together.html#cb152-1" aria-hidden="true" tabindex="-1"></a>price_n_wage <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(</span>
<span id="cb152-2"><a href="joining-data-sources-together.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  wagesLong,</span>
<span id="cb152-3"><a href="joining-data-sources-together.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  saleSummary,</span>
<span id="cb152-4"><a href="joining-data-sources-together.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;year&#39;</span>, <span class="st">&#39;Area&#39;</span> <span class="ot">=</span> <span class="st">&#39;localauthority&#39;</span>)</span>
<span id="cb152-5"><a href="joining-data-sources-together.html#cb152-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>… but, oh dear, not quite. What went wrong? <strong>This is a rare occasion when an R error message is actually informative: <em>``Can’t join on ‘year’ x ‘year’ because of incompatible types (character / numeric)’’</em> </strong></p>
<p>Ah: the <em>year</em> variable in one of them is in character format, not number. But which? Looking in the environment panel, we can <strong>click on the arrow symbol to look</strong>. This reveals, under wagesLong:</p>
<p><img src="02_viz_n_wrangling_files/figure-html/unnamed-chunk-80-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The <strong>`chr’</strong> next to <em>year</em> show it’s a character column. So <strong>when we gathered the year column names, they were kept as characters.</strong> Before we can merge, we have to make them the same format:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="joining-data-sources-together.html#cb153-1" aria-hidden="true" tabindex="-1"></a>wagesLong<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(wagesLong<span class="sc">$</span>year)</span></code></pre></div>
<p>Looking back in the environment panel, wagesLong’s year column is now showing itself as <strong>num</strong>. And now we should be able to join:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="joining-data-sources-together.html#cb154-1" aria-hidden="true" tabindex="-1"></a>price_n_wage <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(</span>
<span id="cb154-2"><a href="joining-data-sources-together.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  wagesLong,</span>
<span id="cb154-3"><a href="joining-data-sources-together.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  saleSummary,</span>
<span id="cb154-4"><a href="joining-data-sources-together.html#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;year&#39;</span>, <span class="st">&#39;Area&#39;</span> <span class="ot">=</span> <span class="st">&#39;localauthority&#39;</span>)</span>
<span id="cb154-5"><a href="joining-data-sources-together.html#cb154-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Check <strong>price_n_wage</strong> via the environment panel: <strong>we’ve now got mean price and median wage in the same rows.</strong></p>
<hr />
<p>Now we’ve got those columns together, there are two more things to do:</p>
<ul>
<li><strong>It’s currently the <em>weekly</em> median wage. We want yearly, to get house price as a multiple of yearly pay.</strong></li>
<li>Once we’ve got yearly pay, turn the house prices into a multiple of this.</li>
</ul>
<p>How? Time for:</p>
<hr />
<blockquote>
<p><strong><em>Verb 4: mutate</em>. This allows us to make whole new variables and attach them to our existing dataframe.</strong></p>
</blockquote>
<hr />
<p>All mutate does: it <strong>creates new variables and attaches them to the existing dataframe.</strong> This can be something as simple as a single value. Or, say we want to create a <em>flag</em> indicating areas with a median wage above £300 a week. Using the pipe operator, that would look like:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="joining-data-sources-together.html#cb155-1" aria-hidden="true" tabindex="-1"></a>price_n_wage <span class="ot">&lt;-</span> price_n_wage <span class="sc">%&gt;%</span> </span>
<span id="cb155-2"><a href="joining-data-sources-together.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wages_above_300 =</span> medianwage <span class="sc">&gt;</span> <span class="dv">300</span>)</span></code></pre></div>
<p>Incidentally, we don’t really need that column, so we can drop it with <strong>select</strong> and using a minus:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="joining-data-sources-together.html#cb156-1" aria-hidden="true" tabindex="-1"></a>price_n_wage <span class="ot">&lt;-</span> price_n_wage <span class="sc">%&gt;%</span> </span>
<span id="cb156-2"><a href="joining-data-sources-together.html#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>wages_above_300)</span></code></pre></div>
<p>We want to use mutate for those two jobs: <strong>convert the weekly wage to a yearly one</strong>, and <strong>divide the mean property price by the yearly wage to get a wage multiple value as a house price index.</strong></p>
<p>As with summarise, <strong>mutate</strong> can do multiple variables at the same time. And, very handily, <strong>dplyr</strong> is also a <strong>lazyeval</strong> function. Which means what? This:</p>
<blockquote>
<p><strong>We can define one variable and then use it immediately in the next one.</strong> So we can work out yearly pay, then immediately use that to find the house price multiple. Thus:</p>
</blockquote>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="joining-data-sources-together.html#cb157-1" aria-hidden="true" tabindex="-1"></a>price_n_wage <span class="ot">&lt;-</span> price_n_wage <span class="sc">%&gt;%</span> </span>
<span id="cb157-2"><a href="joining-data-sources-together.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb157-3"><a href="joining-data-sources-together.html#cb157-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">medianwageyearly =</span> medianwage <span class="sc">*</span> <span class="dv">52</span>, <span class="co"># weekly wage to yearly wage</span></span>
<span id="cb157-4"><a href="joining-data-sources-together.html#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">wagemultiple =</span> meanPrice <span class="sc">/</span> medianwageyearly <span class="co"># house price as multiple of that yearly wage</span></span>
<span id="cb157-5"><a href="joining-data-sources-together.html#cb157-5" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><strong>Look again the the price_n_wage</strong> dataframe to check it’s done what we wanted - and then we can <strong>try a plot.</strong></p>
<p>There are too many local authorities to fit in a legend, so we can <strong>use the guides code mentioned above</strong> when we plot, to <strong>remove the legend</strong> so we can get a look at all the data together without the legend messing up the plot. (Try it without the <strong>guides</strong> function to see what I mean.)</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="joining-data-sources-together.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(price_n_wage, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> wagemultiple, <span class="at">colour =</span> Area)) <span class="sc">+</span></span>
<span id="cb158-2"><a href="joining-data-sources-together.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb158-3"><a href="joining-data-sources-together.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> F)</span></code></pre></div>
<p><img src="02_viz_n_wrangling_files/figure-html/unnamed-chunk-87-1.png" width="595.2" style="display: block; margin: auto;" /></p>
<p>So: <strong>we now have house prices as a ratio of median yearly wages.</strong> And there’s one crazily high outlier and it’s difficult to see any effect from the crash. But there are a lot of local authorities here - <strong>how to pick out ones we want to look at?</strong></p>
</div>
<div id="choosing-a-subset-based-on-some-criterion" class="section level2" number="15.4">
<h2><span class="header-section-number">15.4</span> Choosing a subset based on some criterion</h2>
<p>A useful first step to deciding how to pare down your data is to <strong>make an ordered list</strong> of some variable of interest to look at. So say we want to see:</p>
<ul>
<li><strong>The order of wage multiples in the final full year of the data</strong></li>
</ul>
<p>The advantage of making a separate list is: <strong>we can then use it as a tool for selection</strong>. But first, let’s make it. We can just use <strong>filter</strong> to pick out the year we want - but here’s a new verb:</p>
<hr />
<blockquote>
<p><strong><em>Verb 5: arrange</em>. This re-orders the <em>actual dataframe</em> much as <em>sort</em> does in Excel. That’s quite different to anything else we’ve look at, where the actual row order of the data itself didn’t really matter. (It has no impact on grouping or the order of category drawing, for instance).</strong></p>
</blockquote>
<hr />
<p>This is really useful for two reasons: first, if we actually want to <strong>see</strong> the order ourselves. Second, there <em>are</em> some functions that depend on data order, such as <strong>lag</strong> (see the <strong>window functions</strong> on the dplyr cheatsheet).</p>
<p>So here’s the code:</p>
<ul>
<li><strong>use filter to get 2018 only</strong> then</li>
<li><strong>use arrange to sort the whole dataframe by the wage multiple.</strong> Make it <strong>in descending order with the minus.</strong></li>
</ul>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="joining-data-sources-together.html#cb159-1" aria-hidden="true" tabindex="-1"></a>price_n_wage2018 <span class="ot">&lt;-</span> price_n_wage <span class="sc">%&gt;%</span> </span>
<span id="cb159-2"><a href="joining-data-sources-together.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb159-3"><a href="joining-data-sources-together.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>wagemultiple)</span></code></pre></div>
<p><strong>Take a look at the new dataframe: the highest wage multiple is at the top and we can see what local authority it applies to.</strong> No surprise, London local authorities dominate the top of the list. And right at the top, way out in the lead, is <strong>Kensington and Chelsea.</strong> Could this be a combination of England’s most expensive housing with a mixed population (so a lower median wage)?</p>
<blockquote>
<p><strong>We can use a dataframe like this to guide subsetting decisions for graphs.</strong> The essential principle is to <strong>use our selecting dataframe to subset the zones we want.</strong></p>
</blockquote>
<hr />
<p>Say we want to look only at the <strong>ten local authorities with the lowest wage multiple in 2018.</strong> By looking at the data, we can see this is <strong>those with a wage multiple below 5.78.</strong></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="joining-data-sources-together.html#cb160-1" aria-hidden="true" tabindex="-1"></a>zoneselection <span class="ot">&lt;-</span> price_n_wage2018 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(wagemultiple <span class="sc">&lt;</span> <span class="fl">5.78</span>)</span></code></pre></div>
<p>Or, because the data is <strong>ordered by wage multiple</strong>, we could just grab the bottom ten from the dataframe using the <strong>tail function</strong> (the opposite of head, this gives us the last rows):</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="joining-data-sources-together.html#cb161-1" aria-hidden="true" tabindex="-1"></a>zoneselection <span class="ot">&lt;-</span> price_n_wage2018 <span class="sc">%&gt;%</span> <span class="fu">tail</span>(<span class="dv">10</span>)</span></code></pre></div>
<p>Once have this selection, we can tell <strong>ggplot</strong>: <em>``filter areas by those <strong>%in%</strong> our zone selection’’.</em> This is the same principle as when we removed London - using a logical operator in filter:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="joining-data-sources-together.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(price_n_wage <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Area <span class="sc">%in%</span> zoneselection<span class="sc">$</span>Area), </span>
<span id="cb162-2"><a href="joining-data-sources-together.html#cb162-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> wagemultiple, <span class="at">colour =</span> Area)) <span class="sc">+</span></span>
<span id="cb162-3"><a href="joining-data-sources-together.html#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() </span></code></pre></div>
<p><img src="02_viz_n_wrangling_files/figure-html/unnamed-chunk-91-1.png" width="595.2" style="display: block; margin: auto;" /></p>
<blockquote>
<p>The <strong>%in% operator</strong> is fantastic: it can be used for multiple selections. As with everything else in R, it <strong>works with vectors</strong> - we just passed it a dataframe column, which is a vector. If we wanted to pass a vector directly, we could - e.g.:</p>
</blockquote>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="joining-data-sources-together.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(price_n_wage <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Area <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;Camden&#39;</span>,<span class="st">&#39;Oxford&#39;</span>,<span class="st">&#39;Wirral&#39;</span>,<span class="st">&#39;Liverpool&#39;</span>)), </span>
<span id="cb163-2"><a href="joining-data-sources-together.html#cb163-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> wagemultiple, <span class="at">colour =</span> Area)) <span class="sc">+</span></span>
<span id="cb163-3"><a href="joining-data-sources-together.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() </span></code></pre></div>
<blockquote>
<p><strong>So the impact of the crash appears to be quite apparent in some of the local authorities with the cheapest housing. Wage multiples appear to have <em>decreased over time</em> since the crash.</strong></p>
</blockquote>
<hr />
<p>You might also want to <strong>select particular row numbers</strong> based on the data you can see in the View panel. Row numbers are shown on the left. Say we want to look at the <strong>top and bottom five</strong> but <strong>exclude Kensington and Chelsea</strong>. We can use a <strong>new dplyr verb:</strong></p>
<blockquote>
<p><strong><em>Verb 6: slice</em>. Pass in the row numbers you want - simple. Put a minus before the selection to keep all <em>but</em> those. Place in a vector for multiple selections.</strong></p>
</blockquote>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="joining-data-sources-together.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Top ten, excluding Kensington and Chelsea (no vector function needed)</span></span>
<span id="cb164-2"><a href="joining-data-sources-together.html#cb164-2" aria-hidden="true" tabindex="-1"></a>zoneselection <span class="ot">&lt;-</span> price_n_wage2018 <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>)</span>
<span id="cb164-3"><a href="joining-data-sources-together.html#cb164-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-4"><a href="joining-data-sources-together.html#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Top and bottom five, excluding Kensington and Chelsea</span></span>
<span id="cb164-5"><a href="joining-data-sources-together.html#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Use a vector function for multiple selection</span></span>
<span id="cb164-6"><a href="joining-data-sources-together.html#cb164-6" aria-hidden="true" tabindex="-1"></a>zoneselection <span class="ot">&lt;-</span> price_n_wage2018 <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">72</span><span class="sc">:</span><span class="dv">76</span>))</span></code></pre></div>
<p>So: plotting our selected top and bottom five. Let’s also <strong>add the fct_reorder code</strong> we used before to make the legend order more readable. And we’ll <strong>relabel the legend</strong> while we’re at it.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="joining-data-sources-together.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(price_n_wage <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Area <span class="sc">%in%</span> zoneselection<span class="sc">$</span>Area), </span>
<span id="cb165-2"><a href="joining-data-sources-together.html#cb165-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> wagemultiple, <span class="at">colour =</span> <span class="fu">fct_reorder</span>(Area,<span class="sc">-</span>wagemultiple))) <span class="sc">+</span></span>
<span id="cb165-3"><a href="joining-data-sources-together.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb165-4"><a href="joining-data-sources-together.html#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;area&#39;</span>)</span></code></pre></div>
<p><img src="02_viz_n_wrangling_files/figure-html/unnamed-chunk-94-1.png" width="595.2" style="display: block; margin: auto;" /></p>
<blockquote>
<p><strong>The advantage of using a selection dataframe or vector like this: the <em>ggplot</em> code doesn’t need to change. You just need to change the selection.</strong></p>
</blockquote>
<hr />
<p>Pausing for a moment: looking at the plot of top and bottom local authorities by wage multiple, it’s easier to see something about the impact of the crash: <strong>places with cheaper housing have seen a drop in value, relative to wages. Pricier areas have carried on their upward climb, after a brief dip.</strong></p>
<blockquote>
<p><strong>We’ll come back to the wage multiple data in the facets section later, if you want to look at this in more detail.</strong></p>
</blockquote>
<p>We’ll stop there, but it’s worth mulling the following: if we plot <strong>wage multiple of house price versus the actual wage</strong>…</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="joining-data-sources-together.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(price_n_wage2018, <span class="fu">aes</span>(<span class="at">x =</span> wagemultiple, <span class="at">y =</span> medianwage)) <span class="sc">+</span></span>
<span id="cb166-2"><a href="joining-data-sources-together.html#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="02_viz_n_wrangling_files/figure-html/unnamed-chunk-95-1.png" width="595.2" style="display: block; margin: auto;" /></p>
<p>… while there’s mostly a linear positive relationship, there are outliers in both directions: Kensington and Chelsea we’ve already seen, that’s the point on the right. But there are <em>also</em> places with very low wage multiples but <strong>high median wages</strong>. How might you dig into that further?</p>
<hr />
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using-factors-to-control-order-of-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="saving-ggplots-as-image-files.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
